Version 4
SHEET 1 3284 776
WIRE -384 -416 -384 -480
WIRE -192 -416 -192 -480
WIRE 0 -416 0 -480
WIRE -384 -288 -384 -336
WIRE -192 -288 -192 -336
WIRE 0 -288 0 -336
WIRE 2576 -128 2368 -128
WIRE 2688 -128 2656 -128
WIRE 2736 -128 2688 -128
WIRE 2976 -128 2816 -128
WIRE 272 -96 272 -128
WIRE 400 -96 272 -96
WIRE 624 -96 464 -96
WIRE 768 -96 624 -96
WIRE 992 -96 832 -96
WIRE 1408 -96 992 -96
WIRE 1840 -96 1408 -96
WIRE 2208 -96 2208 -144
WIRE 2416 -96 2208 -96
WIRE 2208 -48 2208 -96
WIRE 2896 -16 2896 -48
WIRE 2688 0 2688 -128
WIRE 2864 0 2688 0
WIRE 624 16 624 -96
WIRE 992 16 992 -96
WIRE 1408 16 1408 -96
WIRE 2976 16 2976 -128
WIRE 2976 16 2928 16
WIRE 3104 16 2976 16
WIRE 3264 16 3184 16
WIRE 272 32 272 -96
WIRE 416 32 272 32
WIRE 2416 32 2416 -96
WIRE 2576 32 2416 32
WIRE 2768 32 2656 32
WIRE 2864 32 2768 32
WIRE 1840 48 1840 -96
WIRE 2208 80 2208 32
WIRE 2368 80 2368 -128
WIRE 2368 80 2208 80
WIRE 2768 80 2768 32
WIRE 1776 96 1712 96
WIRE 2208 96 2208 80
WIRE 3264 96 3264 16
WIRE 2896 112 2896 48
WIRE 416 128 416 32
WIRE 1408 176 1408 96
WIRE 1712 176 1712 96
WIRE 1712 176 1408 176
WIRE 1840 176 1840 144
WIRE 2160 176 1840 176
WIRE 992 192 992 80
WIRE 2208 192 2208 176
WIRE 2768 192 2768 160
WIRE 1840 208 1840 176
WIRE 416 224 416 208
WIRE 624 224 624 80
WIRE 624 224 416 224
WIRE 1408 224 1408 176
WIRE 416 256 416 224
WIRE 1712 256 1712 176
WIRE 1776 256 1712 256
WIRE 1168 272 1056 272
WIRE 1344 272 1248 272
WIRE 112 304 -32 304
WIRE 352 304 192 304
WIRE 1408 384 1408 320
WIRE 1840 384 1840 304
WIRE 2208 384 2208 192
WIRE 416 416 416 352
WIRE 1056 528 1056 272
WIRE 1056 528 992 528
WIRE 2208 528 2208 464
FLAG -384 -288 0
FLAG -192 -288 0
FLAG 992 192 0
FLAG 2208 528 0
FLAG 1840 384 0
FLAG 0 -288 0
FLAG 1408 384 0
FLAG 416 416 0
FLAG 2896 112 0
FLAG 2768 192 0
FLAG 3264 96 0
FLAG -384 -480 VCC
FLAG 272 -128 VCC
FLAG 2896 -48 VCC
FLAG 2208 -144 VCC
FLAG -192 -480 PumpPWM
FLAG -32 304 PumpPWM
FLAG 0 -480 BuckControlPWM
FLAG 992 528 BuckControlPWM
SYMBOL voltage -384 -432 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 20
SYMBOL schottky 400 -80 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N5817
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 768 -80 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N5817
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap 608 16 R0
SYMATTR InstName C1
SYMATTR Value 47µ
SYMBOL cap 976 16 R0
SYMATTR InstName C2
SYMATTR Value 47µ
SYMBOL voltage -192 -432 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 70 174 VLeft 2
SYMATTR InstName V2
SYMATTR Value PULSE(0 3.3 0 1p 1p 1ms 2ms)
SYMBOL res 2192 368 R0
SYMATTR InstName RL
SYMATTR Value 5
SYMBOL nmos 2160 96 R0
SYMATTR InstName M1
SYMATTR Value IRFZ44N
SYMBOL npn 1776 48 R0
SYMATTR InstName Q1
SYMATTR Value 2N2222
SYMBOL pnp 1776 304 M180
SYMATTR InstName Q2
SYMATTR Value 2N2907
SYMBOL voltage 0 -432 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 74 177 VLeft 2
SYMATTR InstName V3
SYMATTR Value PULSE(0 3.3 0 1p 1p 1ms 5ms)
SYMBOL npn 1344 224 R0
SYMATTR InstName Q3
SYMBOL res 1392 0 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res 1264 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RB2
SYMATTR Value 10k
SYMBOL npn 352 256 R0
SYMATTR InstName Q4
SYMBOL res 400 112 R0
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res 208 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RB1
SYMATTR Value 10k
SYMBOL res 2192 -64 R0
SYMATTR InstName Rs
SYMATTR Value 0.1
SYMBOL OpAmps\\UniversalOpamp2 2896 16 R0
SYMATTR InstName U1
SYMBOL res 2784 176 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL res 2560 48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res 2672 -144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res 2832 -144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 100k
SYMBOL res 3200 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 1k
TEXT -536 16 Left 2 !.tran 20ms
TEXT 520 -160 Left 2 ;Charge pump
TEXT 1640 32 Left 2 ;Push-pull driver
TEXT 1128 192 Left 2 ;Control PWM
TEXT 2240 360 Left 2 ;Load
TEXT 2776 -192 Left 2 ;10x differential amplifier
TEXT 1992 -24 Left 2 ;0-3A -> 0-0.3mV
